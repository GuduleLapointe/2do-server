<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Hypervents: Hypergrid Events across the Metaversum</title>
  <meta name="description" content="Hypervents: Hypergrid Events across the Metaversum">
  <meta name="author" content="linkwater">
  <link rel="stylesheet" href="style.css">
  <script src="jquery-1.11.3.min.js"></script>
  <script src="moment.min.js"></script>
  <script src="moment-timezone-with-data-2010-2020.js"></script>
  <script>
    $(document).ready(function() {
        $("div#events").html("<h1>Events</h1>")

        $.getJSON("events.json", function(data) {
            tzname = "Europe/Amsterdam"

            $("div#events").append($('<table class="eventlist"></table>'));

            for(var i=0;i<data.length;i++) {
                start = moment(data[i].start)
                end = moment(data[i].end)

                var tr  = '<tr class="eventoverview">';
                tr = tr + '<td class="eventtime">' + start.tz(tzname).format("ddd, MMM D, ha") + ' - ';
                tr = tr + end.tz(tzname).format("ha") + " " + start.tz(tzname).format("z") + '</td>';

                tr = tr + '<td class="eventtitle">&#9654; ' + data[i].title + '</td></tr>';

                var node1 = $(tr);
                var node2 = $('<tr class="eventdesc"><td></td><td class="eventdesc">' + data[i].description + '</td></tr>');
                var node3 = $('<tr class="eventhgurl"><td></td><td class="eventhgurl"><span>' + data[i].hgurl + '</span></td><td></td></tr>');

                node1.attr('id','eventoverview'+String(i));
                node1.data('eventid',i);
                node2.attr('id','eventdesc'+String(i));
                node2.data('eventid',i);
                node3.attr('id','eventhgurl'+String(i));
                node3.data('eventid',i);

                node1.click(function() {
                    //console.log($(this).data('eventid')); 
                    $("tr#eventdesc"+String($(this).data('eventid'))).toggle();
                    $("tr#eventhgurl"+String($(this).data('eventid'))).toggle();
                });
               
                //$("div#events table").append($(tr).click(function() { console.log("foo"); }));

                $("div#events table").append(node1);
                $("div#events table").append(node3);
                $("div#events table").append(node2);

            }

        });
    });
  </script>
</head>
<body>
<div id="events">
non-javascript client sees this
</div>
</body>
</html>
